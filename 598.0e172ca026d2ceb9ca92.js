"use strict";(self.webpackChunkreact_blog=self.webpackChunkreact_blog||[]).push([[598],{9272:function(e,a,t){t.d(a,{I:function(){return c}});var r=t(7090),s=t(7294),l=t(5893);const c=(0,s.memo)((e=>{const{className:a,value:t,onChange:c,label:i,type:o="text",autofocus:n,readonly:d,...g}=e,u=(0,s.useRef)(null);(0,s.useEffect)((()=>{n&&u.current?.focus()}),[n]);const h={fTN1PnWu:d};return(0,l.jsxs)("div",{className:(0,r.A)("yiPASP1v",h,[a]),children:[i&&(0,l.jsx)("div",{className:"v71VlLMX",children:i}),(0,l.jsx)("input",{...g,ref:u,type:o,value:t,readOnly:d,onChange:e=>{c?.(e.target.value)},className:"LVdIPwcx"})]})}))},8962:function(e,a,t){t.r(a),t.d(a,{default:function(){return $}});var r=t(7090),s=t(5443),l=t(7294),c=t(4839),i=t(3562),o=t(2647),n=t(8498),d=t(9655),g=t(1913),u=t(1992),h=t(4868),p=t(9272),m=t(4268);const v=e=>e.articlesPage?.isLoading||!1,y=e=>e.articlesPage?.error,P=e=>e.articlesPage?.view||g.GA.TILE,f=e=>e.articlesPage?.page||1,S=e=>e.articlesPage?.sort??g.$B.CREATED,x=e=>e.articlesPage?.order??"asc",C=e=>e.articlesPage?.search??"",L=e=>e.articlesPage?.type??g.Iq.ALL,A=(0,m.hg)("articlesPage/fetchArticlesList",(async(e,a)=>{const{rejectWithValue:t,extra:r,getState:s}=a,l=s().articlesPage?.limit||9,c=f(s()),i=S(s()),o=x(s()),n=C(s()),d=L(s());try{u={sort:i,order:o,search:n,type:d},window.history.pushState(null,"",(e=>{const a=new URLSearchParams(window.location.search);return Object.entries(e).forEach((e=>{let[t,r]=e;void 0!==r&&a.set(t,r)})),`?${a.toString()}`})(u));const e=await r.api.get("/articles",{params:{_expand:"user",_limit:l,_page:c,_sort:i,_order:o,q:n,type:d===g.Iq.ALL?void 0:d}});if(!e.data)throw new Error;return e.data}catch(e){return t("error")}var u}));var w=t(5008);const j=(0,m.HF)({selectId:e=>e.id}),T=j.getSelectors((e=>e.articlesPage||j.getInitialState())),N=(0,m.oM)({name:"articleDetailsCommentSlice",initialState:j.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:g.GA.TILE,page:1,limit:4,hasMore:!0,isInited:!1,sort:g.$B.CREATED,search:"",order:"asc",type:g.Iq.ALL}),reducers:{setView:(e,a)=>{e.view=a.payload,localStorage.setItem(w.fK,a.payload)},setPage:(e,a)=>{e.page=a.payload},setSort:(e,a)=>{e.sort=a.payload},setSearch:(e,a)=>{e.search=a.payload},setOrder:(e,a)=>{e.order=a.payload},setType:(e,a)=>{e.type=a.payload},initState:e=>{const a=localStorage.getItem(w.fK);e.view=a,e.limit=a===g.GA.LIST?4:9,e.isInited=!0}},extraReducers:e=>{e.addCase(A.pending,((e,a)=>{e.error=void 0,e.isLoading=!0,a.meta.arg.replace&&j.removeAll(e)})).addCase(A.fulfilled,((e,a)=>{e.isLoading=!1,e.hasMore=a.payload.length>=e.limit,a.meta.arg.replace?j.setAll(e,a.payload):j.addMany(e,a.payload)})).addCase(A.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{reducer:b,actions:I}=N;var E=t(5893);const k=(0,l.memo)((e=>{const{className:a}=e,{t:t}=(0,s.$)("article"),c=(0,o.T)(),i=(0,u.v9)(P),n=(0,u.v9)(S),d=(0,u.v9)(x),m=(0,u.v9)(C),v=(0,u.v9)(L),y=(0,l.useCallback)((()=>{c(A({replace:!0}))}),[c]),f=((e,a)=>{const t=(0,l.useRef)();return(0,l.useCallback)((function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e(...r)}),500)}),[e,500])})(y),w=(0,l.useCallback)((e=>{c(I.setView(e)),c(I.setPage(1)),y()}),[c,y]),j=(0,l.useCallback)((e=>{c(I.setSort(e)),c(I.setPage(1)),y()}),[c,y]),T=(0,l.useCallback)((e=>{c(I.setOrder(e)),c(I.setPage(1)),y()}),[c,y]),N=(0,l.useCallback)((e=>{c(I.setSearch(e)),c(I.setPage(1)),f()}),[c,f]),b=(0,l.useCallback)((e=>{c(I.setType(e)),c(I.setPage(1)),y()}),[c,y]);return(0,E.jsxs)("div",{className:(0,r.A)("",{},[a]),children:[(0,E.jsxs)("div",{className:"pyOjonnp",children:[(0,E.jsx)(g.xT,{sort:n,order:d,onChangeSort:j,onChangeOrder:T}),(0,E.jsx)(g.Vv,{view:i,onViewClick:w})]}),(0,E.jsx)(h.Z,{className:"QkNSez8q",children:(0,E.jsx)(p.I,{label:t("SearchLabel"),value:m,onChange:N})}),(0,E.jsx)(g.XL,{className:"JHbc4jKB",value:v,onChangeType:b})]})})),R=(0,m.hg)("articlesPage/fetchNextArticlePage",(async(e,a)=>{const{getState:t,dispatch:r}=a,s=t().articlesPage?.hasMore,l=f(t()),c=v(t());s&&!c&&(r(I.setPage(l+1)),r(A({})))})),O=(0,m.hg)("articlesPage/initArticlesPage",(async(e,a)=>{const{getState:t,dispatch:r}=a;if(!t().articlesPage?.isInited){const a=e.get("order"),t=e.get("sort"),s=e.get("search"),l=e.get("type");a&&r(I.setOrder(a)),t&&r(I.setSort(t)),s&&r(I.setSearch(s)),l&&r(I.setType(l)),r(I.initState()),r(A({}))}}));var q=t(6276);const V=(0,l.memo)((e=>{const{className:a}=e,{t:t}=(0,s.$)("article"),r=(0,u.v9)(T.selectAll),l=(0,u.v9)(v),c=(0,u.v9)(y),i=(0,u.v9)(P);return c?(0,E.jsx)(q.xv,{theme:q.lg.ERROR,align:q.PH.CENTER,title:t("ArticlesLoadingErrorTitle"),text:t("ArticlesLoadingErrorText"),TitleTag:"h1"}):(0,E.jsx)(g.wD,{articles:r,view:i,isLoading:l,className:a})})),_={articlesPage:b},M=e=>{const{className:a}=e,{t:t}=(0,s.$)("article"),g=(0,o.T)(),[u]=(0,d.lr)();(0,i.Q)((()=>{g(O(u))}));const h=(0,l.useCallback)((()=>{g(R())}),[g]);return(0,E.jsx)(c.W,{reducers:_,removeAfterUnmount:!1,children:(0,E.jsxs)(n.T,{className:(0,r.A)("rfWa2r3q",{},[a]),onScrollEnd:h,children:[t("ArticlesPage"),(0,E.jsx)(k,{}),(0,E.jsx)(V,{className:"UsH35LqR"})]})})};var $=(0,l.memo)(M)}}]);