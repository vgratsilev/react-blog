"use strict";(self.webpackChunkreact_blog=self.webpackChunkreact_blog||[]).push([[244],{9272:function(e,a,r){r.d(a,{I:function(){return s}});var n=r(7090),t=r(7294),l=r(5893);const s=(0,t.memo)((e=>{const{className:a,value:r,onChange:s,label:o,type:i="text",autofocus:c,readonly:d,...u}=e,C=(0,t.useRef)(null);(0,t.useEffect)((()=>{c&&C.current?.focus()}),[c]);const m={fTN1PnWu:d};return(0,l.jsxs)("div",{className:(0,n.A)("yiPASP1v",m,[a]),children:[o&&(0,l.jsx)("div",{className:"v71VlLMX",children:o}),(0,l.jsx)("input",{...u,ref:C,type:i,value:r,readOnly:d,onChange:e=>{s?.(e.target.value)},className:"LVdIPwcx"})]})}))},1244:function(e,a,r){r.r(a),r.d(a,{default:function(){return z}});var n=r(7090),t=r(8498),l=r(157),s=r(7294),o=r(5443),i=r(2647),c=r(1992),d=r(3562),u=r(6276),C=r(9272),m=r(349),g=r(4660);let h;!function(e){e.USD="USD",e.RUB="RUB",e.EUR="EUR"}(h||(h={}));var f=r(9376),R=r(5893);const y=Object.keys(h).map((e=>({value:e,content:e}))),v=(0,s.memo)((e=>{const{className:a,value:r,onChange:t,readonly:l}=e,{t:i}=(0,o.$)(),c=(0,s.useCallback)((e=>{t?.(e)}),[t]);return(0,R.jsx)(f.wb,{className:(0,n.A)("",{},[a]),label:i("CurrencyLabel"),items:y,value:r,defaultValue:i("SelectCurrencyDefaultValue"),onChange:c,readonly:l})}));let E;!function(e){e.USA="US",e.Russia="RU",e.Canada="CA"}(E||(E={}));const x=Object.keys(E).map((e=>({value:e,content:e}))),p=(0,s.memo)((e=>{const{className:a,value:r,onChange:t,readonly:l}=e,{t:i}=(0,o.$)(),c=(0,s.useCallback)((e=>{t?.(e)}),[t]);return(0,R.jsx)(f.wb,{className:(0,n.A)("",{},[a]),label:i("CountryLabel"),items:x,value:r,defaultValue:i("SelectCountryDefaultValue"),onChange:c,readonly:l})}));var N="cH3_ZM3Y",b="ZTyX8_n9";const j=e=>{const{className:a,data:r,isLoading:t,error:s,readonly:i,onChangeFirstname:c,onChangeLastname:d,onChangeUsername:h,onChangeAge:f,onChangeCity:y,onChangeAvatar:E,onChangeCurrency:x,onChangeCountry:j}=e,{t:T}=(0,o.$)("profile");if(t)return(0,R.jsx)(l.U,{className:(0,n.A)(N,{},[a,"t07ZxFGs"]),maxWidth:!0,justify:"center",children:(0,R.jsx)(m.a,{})});if(s)return(0,R.jsx)(l.g,{className:(0,n.A)(N,{},[a,"i5YK3SSb"]),maxWidth:!0,children:(0,R.jsx)(u.xv,{theme:u.lg.ERROR,align:u.PH.CENTER,title:T("ProfileLoadingErrorTitle"),text:T("ProfileLoadingErrorText"),TitleTag:"h1"})});const A={DjTe7269:!i};return(0,R.jsxs)(l.g,{className:(0,n.A)(N,A,[a]),maxWidth:!0,gap:"8",children:[r?.avatar&&(0,R.jsx)(l.U,{maxWidth:!0,justify:"center",children:(0,R.jsx)(g.q,{src:r?.avatar,alt:T("AvatarLabel"),size:150})}),(0,R.jsx)(C.I,{value:r?.firstname,label:T("FirstNameLabel"),className:b,readonly:i,onChange:c}),(0,R.jsx)(C.I,{value:r?.lastname,label:T("LastNameLabel"),className:b,readonly:i,onChange:d}),(0,R.jsx)(C.I,{value:r?.username,label:T("UsernameLabel"),className:b,readonly:i,onChange:h}),(0,R.jsx)(C.I,{value:r?.age,label:T("AgeLabel"),className:b,readonly:i,type:"number",min:12,max:150,step:1,onChange:f}),(0,R.jsx)(C.I,{value:r?.city,label:T("CityLabel"),className:b,readonly:i,onChange:y}),(0,R.jsx)(C.I,{value:r?.avatar,label:T("AvatarLabel"),className:b,readonly:i,onChange:E}),(0,R.jsx)(v,{className:b,value:r?.currency,onChange:x,readonly:i}),(0,R.jsx)(p,{className:b,value:r?.country,onChange:j,readonly:i})]})};var T=r(4839);let A;!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(A||(A={}));var O=r(5625),I=r(2790);const U=e=>e?.profile?.readonly;var L=r(4268);const _=e=>e?.profile?.form,k=(0,L.hg)("profile/updateProfileData",(async(e,a)=>{const{rejectWithValue:r,extra:n,getState:t}=a,l=_(t()),s=(e=>{if(!e)return{isValid:!1,errors:[A.NO_DATA]};const{firstname:a,lastname:r,age:n,country:t}=e,l=[];return a&&r||l.push(A.INCORRECT_USER_DATA),n&&Number.isInteger(n)||l.push(A.INCORRECT_AGE),t||l.push(A.INCORRECT_COUNTRY),{isValid:l.length<1,errors:l}})(l);if(!s.isValid)return r(s.errors);try{const e=await n.api.put(`/profile/${l?.id}`,l);if(!e.data)throw new Error;return e.data}catch(e){return r([A.SERVER_ERROR])}})),S=(0,L.hg)("profile/fetchProfileData",(async(e,a)=>{const{rejectWithValue:r,extra:n}=a;try{const a=await n.api.get(`/profile/${e}`);if(!a.data)throw new Error;return a.data}catch(e){return r("error")}})),P=(0,L.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.form=e.data,e.validateErrors=void 0},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}}},extraReducers:e=>{e.addCase(S.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(S.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(S.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(k.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(k.fulfilled,((e,a)=>{e.isLoading=!1,e.readonly=!0,e.data=a.payload,e.form=a.payload,e.validateErrors=void 0})).addCase(k.rejected,((e,a)=>{e.isLoading=!1,e.validateErrors=a.payload}))}}),{actions:D}=P,{reducer:V}=P,w=e=>e?.profile?.data,W=(0,s.memo)((e=>{const{className:a}=e,{t:r}=(0,o.$)("profile"),t=(0,c.v9)(U),d=(0,i.T)(),C=(0,c.v9)(O.m5),m=(0,c.v9)(w),g=C?.id===m?.id,h=(0,s.useCallback)((()=>{d(D.setReadonly(!1))}),[d]),f=(0,s.useCallback)((()=>{d(D.cancelEdit())}),[d]),y=(0,s.useCallback)((()=>{d(k())}),[d]);return(0,R.jsxs)(l.U,{maxWidth:!0,justify:"between",className:(0,n.A)("",{},[a]),children:[(0,R.jsx)(u.xv,{title:r("ProfilePage"),TitleTag:"h1"}),g&&(0,R.jsxs)(R.Fragment,{children:[t&&(0,R.jsx)(I.zx,{theme:I.bn.OUTLINE,onClick:h,children:r("ChangeBtn")}),!t&&(0,R.jsxs)(l.U,{gap:"8",children:[(0,R.jsx)(I.zx,{theme:I.bn.OUTLINE,onClick:y,children:r("SaveBtn")}),(0,R.jsx)(I.zx,{theme:I.bn.OUTLINE_RED,onClick:f,children:r("CancelBtn")})]})]})]})})),$=e=>e?.profile?.isLoading,F=e=>e?.profile?.validateErrors,M=e=>e?.profile?.error,Y={profile:V},B=(0,s.memo)((e=>{const{className:a,id:r}=e,{t:t}=(0,o.$)("profile"),C=(0,i.T)(),m=(0,c.v9)(_),g=(0,c.v9)($),h=(0,c.v9)(M),f=(0,c.v9)(U),y=(0,c.v9)(F),v={[A.SERVER_ERROR]:t("ServerError"),[A.NO_DATA]:t("NoDataError"),[A.INCORRECT_COUNTRY]:t("IncorrectCountryError"),[A.INCORRECT_AGE]:t("IncorrectAgeError"),[A.INCORRECT_USER_DATA]:t("IncorrectUserDataError")};(0,d.Q)((()=>{r&&C(S(r))}));const E=(0,s.useCallback)((e=>{C(D.updateProfile({firstname:e||""}))}),[C]),x=(0,s.useCallback)((e=>{C(D.updateProfile({lastname:e||""}))}),[C]),p=(0,s.useCallback)((e=>{C(D.updateProfile({username:e||""}))}),[C]),N=(0,s.useCallback)((e=>{C(D.updateProfile({age:Number(e||0)}))}),[C]),b=(0,s.useCallback)((e=>{C(D.updateProfile({city:e||""}))}),[C]),O=(0,s.useCallback)((e=>{C(D.updateProfile({avatar:e||""}))}),[C]),I=(0,s.useCallback)((e=>{C(D.updateProfile({currency:e}))}),[C]),L=(0,s.useCallback)((e=>{C(D.updateProfile({country:e}))}),[C]);return(0,R.jsx)(T.W,{reducers:Y,children:(0,R.jsxs)(l.g,{gap:"8",maxWidth:!0,className:(0,n.A)("",{},[a]),children:[(0,R.jsx)(W,{}),y?.length&&y?.length>0&&y?.map((e=>(0,R.jsx)(u.xv,{theme:u.lg.ERROR,text:v[e]},e))),(0,R.jsx)(j,{data:m,isLoading:g,error:h,readonly:f,onChangeFirstname:E,onChangeLastname:x,onChangeUsername:p,onChangeAge:N,onChangeCity:b,onChangeAvatar:O,onChangeCurrency:I,onChangeCountry:L})]})})}));var G=r(9250),z=e=>{const{className:a}=e,{t:r}=(0,o.$)("profile");let{id:s}=(0,G.UO)();return s?(0,R.jsx)(t.T,{className:(0,n.A)("",{},[a]),children:(0,R.jsx)(l.g,{gap:"16",maxWidth:!0,children:(0,R.jsx)(B,{id:s})})}):(0,R.jsx)(u.xv,{text:r("ProfileNotFoundErrorText")})}},4839:function(e,a,r){r.d(a,{W:function(){return s}});var n=r(7294),t=r(1992),l=r(5893);const s=e=>{const{children:a,reducers:r,removeAfterUnmount:s=!0}=e,o=(0,t.I0)(),i=(0,t.oR)();return(0,n.useEffect)((()=>{const e=i.reducerManager.getReducerMap();return Object.entries(r).forEach((a=>{let[r,n]=a;e[r]||(i.reducerManager.add(r,n),o({type:`@INIT ${r} reducer`}))})),()=>{s&&Object.entries(r).forEach((e=>{let[a]=e;i.reducerManager.remove(a),o({type:`@DESTROY ${a} reducer`})}))}}),[]),(0,l.jsx)(l.Fragment,{children:a})}}}]);