"use strict";(self.webpackChunkreact_blog=self.webpackChunkreact_blog||[]).push([[70],{4070:(e,n,r)=>{r.r(n),r.d(n,{default:()=>B});var a,t=r(5893),o=r(927),l=r(5150);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(a||(a={}));var i,u=r(7168),s=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.form},c=(0,u.hg)("profile/updateProfileData",(function(e,n){return r=void 0,t=void 0,l=function(){var e,r,t,o,l,i,u;return function(e,n){var r,a,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(t=2&o[0]?a.return:o[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,o[1])).done)return t;switch(a=0,t&&(o=[2&o[0],t.value]),o[0]){case 0:case 1:t=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!t||o[1]>t[0]&&o[1]<t[3])){l.label=o[1];break}if(6===o[0]&&l.label<t[1]){l.label=t[1],t=o;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(o);break}t[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],a=0}finally{r=t=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(c){switch(c.label){case 0:if(e=n.rejectWithValue,r=n.extra,t=n.getState,o=s(t()),!(l=function(e){if(!e)return{isValid:!1,errors:[a.NO_DATA]};var n=e.firstname,r=e.lastname,t=e.age,o=e.country,l=[];return n&&r||l.push(a.INCORRECT_USER_DATA),t&&Number.isInteger(t)||l.push(a.INCORRECT_AGE),o||l.push(a.INCORRECT_COUNTRY),{isValid:l.length<1,errors:l}}(o)).isValid)return[2,e(l.errors)];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,r.api.put("/profile",o)];case 2:if(!(i=c.sent()).data)throw new Error;return[2,i.data];case 3:return u=c.sent(),window.console.log(u),[2,e([a.SERVER_ERROR])];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function a(e){try{u(l.next(e))}catch(e){n(e)}}function i(e){try{u(l.throw(e))}catch(e){n(e)}}function u(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(a,i)}u((l=l.apply(r,t||[])).next())}));var r,t,o,l})),d=(0,u.hg)("profile/fetchProfileData",(function(e,n){return r=void 0,a=void 0,o=function(){var e,r,a,t;return function(e,n){var r,a,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(t=2&o[0]?a.return:o[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,o[1])).done)return t;switch(a=0,t&&(o=[2&o[0],t.value]),o[0]){case 0:case 1:t=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!t||o[1]>t[0]&&o[1]<t[3])){l.label=o[1];break}if(6===o[0]&&l.label<t[1]){l.label=t[1],t=o;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(o);break}t[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],a=0}finally{r=t=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(o){switch(o.label){case 0:e=n.rejectWithValue,r=n.extra,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.api.get("/profile")];case 2:if(!(a=o.sent()).data)throw new Error;return[2,a.data];case 3:return t=o.sent(),window.console.log(t),[2,e("error")];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function l(e){try{u(o.next(e))}catch(e){n(e)}}function i(e){try{u(o.throw(e))}catch(e){n(e)}}function u(n){var r;n.done?e(n.value):(r=n.value,r instanceof t?r:new t((function(e){e(r)}))).then(l,i)}u((o=o.apply(r,a||[])).next())}));var r,a,t,o})),f=function(){return f=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},f.apply(this,arguments)},v=(0,u.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.form=e.data,e.validateErrors=void 0},updateProfile:function(e,n){e.form=f(f({},e.form),n.payload)}},extraReducers:function(e){e.addCase(d.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(d.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(d.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(c.pending,(function(e){e.validateErrors=void 0,e.isLoading=!0})).addCase(c.fulfilled,(function(e,n){e.isLoading=!1,e.readonly=!0,e.data=n.payload,e.form=n.payload,e.validateErrors=void 0})).addCase(c.rejected,(function(e,n){e.isLoading=!1,e.validateErrors=n.payload}))}}),p=v.actions,h=v.reducer,y=r(5443),m=r(6176),C=r(9822),g=r(2463),b=r(9342);!function(e){e.USD="USD",e.RUB="RUB",e.EUR="EUR"}(i||(i={}));var R=r(7294);var x,N=function(){return N=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},N.apply(this,arguments)},E=(0,R.memo)((function(e){var n,r=e.className,a=e.label,l=e.options,i=e.value,u=e.onChange,s=e.readonly,c=(0,R.useMemo)((function(){return null==l?void 0:l.map((function(e){return(0,t.jsx)("option",N({value:e.value},{children:e.content}),e.value)}))}),[l]),d=((n={}).kluot2iC=s,n);return(0,t.jsxs)("div",N({className:(0,o.A)("i8c9qOHJ",d,[r])},{children:[a&&(0,t.jsx)("div",N({className:"G1uuf7Bp"},{children:a})),(0,t.jsx)("select",N({"data-testid":"selectBox",className:"VOKOuKGo",value:i,onChange:function(e){null==u||u(e.target.value)},disabled:s},{children:c}))]}))})),O=Object.keys(i).map((function(e){return{value:e,content:e}})),j=(0,R.memo)((function(e){var n=e.className,r=e.value,a=e.onChange,l=e.readonly,i=(0,y.$)().t,u=(0,R.useCallback)((function(e){null==a||a(e)}),[a]);return(0,t.jsx)(E,{className:(0,o.A)("",{},[n]),label:i("CurrencyLabel"),options:O,value:r,onChange:u,readonly:l})}));!function(e){e.USA="US",e.Russia="RU",e.Canada="CA"}(x||(x={}));var A=Object.keys(x).map((function(e){return{value:e,content:e}})),w=(0,R.memo)((function(e){var n=e.className,r=e.value,a=e.onChange,l=e.readonly,i=(0,y.$)().t,u=(0,R.useCallback)((function(e){null==a||a(e)}),[a]);return(0,t.jsx)(E,{className:(0,o.A)("",{},[n]),label:i("CountryLabel"),options:A,value:r,onChange:u,readonly:l})}));const T={profileCard:"cH3_ZM3Y",loading:"t07ZxFGs",error:"i5YK3SSb",input:"ZTyX8_n9",avatarWrapper:"bEFNSahN",editing:"DjTe7269"};var L=function(){return L=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},L.apply(this,arguments)},P=function(e){var n,r=e.className,a=e.data,l=e.isLoading,i=e.error,u=e.readonly,s=e.onChangeFirstname,c=e.onChangeLastname,d=e.onChangeUsername,f=e.onChangeAge,v=e.onChangeCity,p=e.onChangeAvatar,h=e.onChangeCurrency,R=e.onChangeCountry,x=(0,y.$)("profile").t;if(l)return(0,t.jsx)("div",L({className:(0,o.A)(T.profileCard,{},[r,T.loading])},{children:(0,t.jsx)(g.a,{})}));if(i)return(0,t.jsx)("div",L({className:(0,o.A)(T.profileCard,{},[r,T.error])},{children:(0,t.jsx)(m.xv,{theme:m.lg.ERROR,align:m.PH.CENTER,title:x("ProfileLoadingErrorTitle"),text:x("ProfileLoadingErrorText")})}));var N=((n={})[T.editing]=!u,n);return(0,t.jsx)("div",L({className:(0,o.A)(T.profileCard,N,[r])},{children:(0,t.jsxs)("div",L({className:T.data},{children:[(null==a?void 0:a.avatar)&&(0,t.jsx)("div",L({className:T.avatarWrapper},{children:(0,t.jsx)(b.q,{src:null==a?void 0:a.avatar,alt:x("AvatarLabel"),size:150})})),(0,t.jsx)(C.I,{value:null==a?void 0:a.firstname,label:x("FirstNameLabel"),className:T.input,readonly:u,onChange:s}),(0,t.jsx)(C.I,{value:null==a?void 0:a.lastname,label:x("LastNameLabel"),className:T.input,readonly:u,onChange:c}),(0,t.jsx)(C.I,{value:null==a?void 0:a.username,label:x("UsernameLabel"),className:T.input,readonly:u,onChange:d}),(0,t.jsx)(C.I,{value:null==a?void 0:a.age,label:x("AgeLabel"),className:T.input,readonly:u,type:"number",min:12,max:150,step:1,onChange:f}),(0,t.jsx)(C.I,{value:null==a?void 0:a.city,label:x("CityLabel"),className:T.input,readonly:u,onChange:v}),(0,t.jsx)(C.I,{value:null==a?void 0:a.avatar,label:x("AvatarLabel"),className:T.input,readonly:u,onChange:p}),(0,t.jsx)(j,{className:T.input,value:null==a?void 0:a.currency,onChange:h,readonly:u}),(0,t.jsx)(w,{className:T.input,value:null==a?void 0:a.country,onChange:R,readonly:u})]}))}))},I=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.isLoading},_=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.error},k=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.readonly},S=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.validateErrors},U=r(7376),z=r(7007),D=r(4763);const M="vP5lJqeW";var F=function(){return F=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},F.apply(this,arguments)},G=(0,R.memo)((function(e){var n=e.className,r=(0,y.$)("profile").t,a=(0,z.v9)(k),l=(0,U.T)(),i=(0,R.useCallback)((function(){l(p.setReadonly(!1))}),[l]),u=(0,R.useCallback)((function(){l(p.cancelEdit())}),[l]),s=(0,R.useCallback)((function(){l(c())}),[l]);return(0,t.jsxs)("div",F({className:(0,o.A)("FDWWAgRG",{},[n])},{children:[(0,t.jsx)(m.xv,{title:r("ProfilePage")}),a&&(0,t.jsx)(D.zx,F({theme:D.bn.OUTLINE,className:M,onClick:i},{children:r("ChangeBtn")})),!a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.zx,F({theme:D.bn.OUTLINE,className:M,onClick:s},{children:r("SaveBtn")})),(0,t.jsx)(D.zx,F({theme:D.bn.OUTLINE_RED,className:"vKEhUm17",onClick:u},{children:r("CancelBtn")}))]})]}))})),V=function(){return V=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},V.apply(this,arguments)},W={profile:h};const B=function(e){var n,r=e.className,i=(0,y.$)("profile").t,u=(0,U.T)(),c=(0,z.v9)(s),f=(0,z.v9)(I),v=(0,z.v9)(_),h=(0,z.v9)(k),C=(0,z.v9)(S),g=((n={})[a.SERVER_ERROR]=i("ServerError"),n[a.NO_DATA]=i("NoDataError"),n[a.INCORRECT_COUNTRY]=i("IncorrectCountryError"),n[a.INCORRECT_AGE]=i("IncorrectAgeError"),n[a.INCORRECT_USER_DATA]=i("IncorrectUserDataError"),n);(0,R.useEffect)((function(){u(d())}),[u]);var b=(0,R.useCallback)((function(e){u(p.updateProfile({firstname:e||""}))}),[u]),x=(0,R.useCallback)((function(e){u(p.updateProfile({lastname:e||""}))}),[u]),N=(0,R.useCallback)((function(e){u(p.updateProfile({username:e||""}))}),[u]),E=(0,R.useCallback)((function(e){u(p.updateProfile({age:Number(e||0)}))}),[u]),O=(0,R.useCallback)((function(e){u(p.updateProfile({city:e||""}))}),[u]),j=(0,R.useCallback)((function(e){u(p.updateProfile({avatar:e||""}))}),[u]),A=(0,R.useCallback)((function(e){u(p.updateProfile({currency:e}))}),[u]),w=(0,R.useCallback)((function(e){u(p.updateProfile({country:e}))}),[u]);return(0,t.jsx)(l.W,V({reducers:W,removeAfterUnmount:!0},{children:(0,t.jsxs)("div",V({className:(0,o.A)("",{},[r])},{children:[(0,t.jsx)(G,{}),(null==C?void 0:C.length)&&(null==C?void 0:C.length)>0&&(null==C?void 0:C.map((function(e){return(0,t.jsx)(m.xv,{theme:m.lg.ERROR,text:g[e]},e)}))),(0,t.jsx)(P,{data:c,isLoading:f,error:v,readonly:h,onChangeFirstname:b,onChangeLastname:x,onChangeUsername:N,onChangeAge:E,onChangeCity:O,onChangeAvatar:j,onChangeCurrency:A,onChangeCountry:w})]}))}))}},5150:(e,n,r)=>{r.d(n,{W:()=>l});var a=r(5893),t=r(7294),o=r(7007),l=function(e){var n=e.children,r=e.reducers,l=e.removeAfterUnmount,i=void 0===l||l,u=(0,o.I0)(),s=(0,o.oR)();return(0,t.useEffect)((function(){return Object.entries(r).forEach((function(e){var n=e[0],r=e[1];s.reducerManager.add(n,r),u({type:"@INIT ".concat(n," reducer")})})),function(){i&&Object.entries(r).forEach((function(e){var n=e[0];s.reducerManager.remove(n),u({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,a.jsx)(a.Fragment,{children:n})}},7376:(e,n,r)=>{r.d(n,{T:()=>t});var a=r(7007),t=function(){return(0,a.I0)()}},9342:(e,n,r)=>{r.d(n,{q:()=>l});var a=r(5893),t=r(927),o=r(7294);var l=(0,o.memo)((function(e){var n=e.className,r=e.src,l=e.size,i=void 0===l?100:l,u=e.alt,s=void 0===u?"avatar":u,c=(0,o.useMemo)((function(){return{width:i,height:i}}),[i]);return(0,a.jsx)("img",{src:r,alt:s,style:c,className:(0,t.A)("GCM50viD",{},[n])})}))},9822:(e,n,r)=>{r.d(n,{I:()=>i});var a=r(5893),t=r(927),o=r(7294);var l=function(){return l=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},l.apply(this,arguments)},i=(0,o.memo)((function(e){var n,r=e.className,i=e.value,u=e.onChange,s=e.label,c=e.type,d=void 0===c?"text":c,f=e.autofocus,v=e.readonly,p=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(a=Object.getOwnPropertySymbols(e);t<a.length;t++)n.indexOf(a[t])<0&&Object.prototype.propertyIsEnumerable.call(e,a[t])&&(r[a[t]]=e[a[t]])}return r}(e,["className","value","onChange","label","type","autofocus","readonly"]),h=(0,o.useRef)(null);(0,o.useEffect)((function(){var e;f&&(null===(e=h.current)||void 0===e||e.focus())}),[f]);var y=((n={}).fTN1PnWu=v,n);return(0,a.jsxs)("div",l({className:(0,t.A)("yiPASP1v",y,[r])},{children:[s&&(0,a.jsx)("div",l({className:"v71VlLMX"},{children:s})),(0,a.jsx)("input",l({},p,{ref:h,type:d,value:i,readOnly:v,onChange:function(e){null==u||u(e.target.value)},className:"LVdIPwcx"}))]}))}))},6176:(e,n,r)=>{r.d(n,{xv:()=>d,PH:()=>u,yH:()=>s,lg:()=>i});var a=r(5893),t=r(927),o=r(7294);const l={textContainer:"z6aHv9ni",left:"dBqPIG8f",right:"j4UBrvei",center:"iJw6m2iu",title:"ikI7VPeL",text:"uNJeeCm1",error:"F9oLXAK4",size_S:"rlqN0bQm",sizeS:"rlqN0bQm",size_M:"OvfxzOos",sizeM:"OvfxzOos",size_L:"swKJ7A5n",sizeL:"swKJ7A5n",size_XL:"jQJCAe6F",sizeXl:"jQJCAe6F"};var i,u,s,c=function(){return c=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},c.apply(this,arguments)};!function(e){e.PRIMARY="primary",e.ERROR="error"}(i||(i={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center"}(u||(u={})),function(e){e.S="size_S",e.M="size_M",e.L="size_L",e.XL="size_XL"}(s||(s={}));var d=(0,o.memo)((function(e){var n=e.className,r=e.title,o=e.text,d=e.theme,f=void 0===d?i.PRIMARY:d,v=e.align,p=void 0===v?u.LEFT:v,h=e.size,y=void 0===h?s.M:h;return(0,a.jsxs)("div",c({className:(0,t.A)(l.textContainer,{},[n,l[f],l[p],l[y]])},{children:[r&&(0,a.jsx)("p",c({className:l.title},{children:r})),o&&(0,a.jsx)("p",c({className:l.text},{children:o}))]}))}))}}]);